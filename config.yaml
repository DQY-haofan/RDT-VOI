# =====================================================================
# å¿«é€Ÿå®éªŒé…ç½® - é’ˆå¯¹Colabç¯å¢ƒä¼˜åŒ–
# =====================================================================
#
# ä¸»è¦æ”¹åŠ¨ï¼š
# 1. å‡å°‘CVæŠ˜æ•°ï¼š5â†’3ï¼ˆå‡å°‘40%è®¡ç®—ï¼‰
# 2. å‡å°‘é¢„ç®—ç‚¹ï¼š6â†’4ï¼ˆå‡å°‘33%è®¡ç®—ï¼‰
# 3. ä¼˜åŒ–é€‰æ‹©ç®—æ³•å‚æ•°
# 4. å¯ç”¨å¿«é€ŸEVIè¿‘ä¼¼
#
# é¢„æœŸæ€»è€—æ—¶ï¼šä»160h â†’ 15hï¼ˆ10å€åŠ é€Ÿï¼‰

experiment:
  name: rdt_fast_experiment
  output_dir: runs
  seed: 202501

numerics:
  linear_solver_tol: 1.0e-07  # ğŸ”§ æ”¾å®½ï¼ˆåŸ1e-8ï¼‰
  cholesky_nugget: 1.0e-08    # ğŸ”§ æ”¾å®½ï¼ˆåŸ1e-9ï¼‰
  logdet_method: cholesky
  pcg_max_iter: 500           # ğŸ”§ å‡åŠï¼ˆåŸ1000ï¼‰

geometry:
  mode: grid2d
  nx: 40
  ny: 40
  h: 5.0

prior:
  nu: 1.0
  kappa: 0.10
  sigma2: 0.30
  alpha: 2
  beta: 1.0e-06
  mu_prior_mean: 2.2
  mu_prior_std: 0.0

sensors:
  pool_fraction: 0.75
  pool_strategy: grid_subsample
  type_mix: [0.4, 0.4, 0.2]
  types:
    - name: inertial_profiler
      noise_std: 0.1
      cost_gbp: 10000.0
      footprint: avg3x3
    - name: photogrammetry
      noise_std: 0.25
      cost_gbp: 5000.0
      footprint: avg3x3
    - name: smartphone
      noise_std: 0.5
      cost_gbp: 500.0
      footprint: avg5x5

decision:
  tau_iri: 2.0
  L_TP_gbp: 5000.0
  L_FP_gbp: 8000.0
  L_FN_gbp: 40000.0
  L_TN_gbp: 0.0

# =====================================================================
# ğŸ”¥ é€‰æ‹©ç®—æ³•ä¼˜åŒ–ï¼ˆå…³é”®åŠ é€Ÿç‚¹ï¼‰
# =====================================================================
selection:
  methods:
    - greedy_mi        # å¿…è·‘
    # - greedy_aopt    # ğŸ”§ æ³¨é‡Šæ‰ï¼ˆæœ€æ…¢çš„æ–¹æ³•ï¼‰
    - uniform          # å¿«é€ŸåŸºçº¿
    - random           # å¿«é€ŸåŸºçº¿

  budgets:
    # - 5              # ğŸ”§ åˆ é™¤å°é¢„ç®—
    - 10
    - 20
    - 40
    # - 60            # ğŸ”§ åˆ é™¤å¤§é¢„ç®—
    # - 80

  greedy_mi:
    lazy: true
    cost_normalized: true
    warmstart_enum: false
    batch_size: 64           # ğŸ”¥ æ–°å¢ï¼šæ‰¹é‡è¯„ä¼°å¤§å°

  greedy_aopt:
    lazy: true
    trace_estimator: hutchpp
    hutchpp_probes: 10       # ğŸ”§ å‡åŠï¼ˆåŸ20ï¼‰
    batch_size: 32           # ğŸ”¥ æ–°å¢

# =====================================================================
# ğŸ”¥ EVIè®¡ç®—ä¼˜åŒ–
# =====================================================================
evi:
  compute_for:
    - greedy_mi
  method: monte_carlo
  monte_carlo_samples: 500   # ğŸ”§ å‡åŠï¼ˆåŸ1000ï¼‰
  unscented_alpha: 1.0
  unscented_beta: 2.0
  unscented_kappa: 0.0

# =====================================================================
# ğŸ”¥ CVä¼˜åŒ–ï¼ˆæœ€å¤§åŠ é€Ÿç‚¹ï¼‰
# =====================================================================
cv:
  scheme: spatial_block
  k_folds: 3                 # ğŸ”§ å‡å°‘ï¼ˆåŸ5ï¼‰
  buffer_width_multiplier: 1.5
  block_strategy: kmeans
  ensure_connected: true

# =====================================================================
# ğŸ”¥ UQä¼˜åŒ–
# =====================================================================
uq:
  bootstrap_method: spatial_block
  bootstrap_samples: 500     # ğŸ”§ å‡åŠï¼ˆåŸ1000ï¼‰
  confidence_level: 0.95
  coverage_percentile: 90
  compute_crps: false

diagnostics:
  morans_i:
    permutations: 499        # ğŸ”§ å‡åŠï¼ˆåŸ999ï¼‰
    weight_type: adjacency
  calibration:
    compute_coverage: true
    compute_msse: true

plots:
  save_formats: [png]        # ğŸ”§ åªä¿å­˜pngï¼ˆåŸpng+pdfï¼‰
  dpi: 150                   # ğŸ”§ é™ä½ï¼ˆåŸ300ï¼‰
  style: seaborn-v0_8-paper
  budget_curves:
    show_ci: true
    metrics:
      - expected_loss
      - rmse
  performance_profile:
    tau_max: 3.0
  critical_difference:
    alpha: 0.05
    test: nemenyi

logging:
  level: INFO
  console: true
  file: true
  jsonl_metrics: true

acceptance:
  m1_grid_size: 1600
  m1_budgets: [10, 20, 40]
  m1_check_monotonic: true
  m1_check_diminishing: true
  m2_min_improvement_vs_random: 0.15
  m2_confidence_level: 0.95
  m3_small_instance_n: 200
  m3_small_instance_k: 8
  m3_max_suboptimality: 1.58
  m4_morans_alpha: 0.05
  m4_coverage_tolerance: 0.05
  m4_msse_tolerance: 0.2

# =====================================================================
# è®¡ç®—é‡åˆ†æ
# =====================================================================
#
# åŸé…ç½®ï¼š
#   5 folds Ã— 4 methods Ã— 6 budgets = 120 experiments
#   æ¯ä¸ªå®éªŒï¼škÃ—N solveï¼Œk=80, N=1200
#   é¢„ä¼°ï¼š160å°æ—¶ï¼ˆSPLUï¼‰
#
# ä¼˜åŒ–åï¼š
#   3 folds Ã— 3 methods Ã— 3 budgets = 27 experiments (-77%)
#   æ¯ä¸ªå®éªŒï¼škÃ—N/batch_size solveï¼ˆæ‰¹é‡ï¼‰
#   é¢„ä¼°ï¼š15å°æ—¶ï¼ˆSPLU + batchï¼‰â†’ 3å°æ—¶ï¼ˆCHOLMOD + batchï¼‰
#
# å¦‚éœ€è¿›ä¸€æ­¥åŠ é€Ÿï¼š
#   - å…ˆè·‘M1ï¼ˆå•æŠ˜ï¼Œå¿«é€ŸéªŒè¯ï¼‰
#   - ç¡®è®¤æ•ˆæœåå†è·‘å®Œæ•´M2