# ============================================================================
# RDT-VoI Simulation Configuration - EXPERT-OPTIMIZED VERSION
# Road Deterioration Testing: Value of Information Framework
#
# ğŸ”¥ ä¸»è¦ä¼˜åŒ–ï¼ˆåŸºäºä¸“å®¶å®¡æŸ¥æ„è§ï¼‰:
#   1. å¢å¼ºä¼ æ„Ÿå™¨æ± å¼‚è´¨æ€§ï¼ˆSNR å’Œæˆæœ¬å¯¹æ¯”åº¦ï¼‰
#   2. ä¼˜åŒ– EVI é¢„ç­›é€‰å‚æ•°ï¼ˆkeep_fraction: 0.25 â†’ 0.6ï¼‰
#   3. å¯ç”¨åˆ†å±‚æµ‹è¯•é›†æŠ½æ ·
#   4. ä¿æŒå†³ç­–æŸå¤±ä¸å¯¹ç§°æ€§ FN:FP = 15:1
#   5. ä¿æŒéå¹³ç¨³å…ˆéªŒ (CV=30%)
# ============================================================================

experiment:
  name: "rdt_voi_expert_optimized"
  seed: 42
  output_dir: "results/expert_optimized"

# ----------------------------------------------------------------------------
# Numerical Settings
# ----------------------------------------------------------------------------
numerics:
  linear_solver_tol: 1.0e-8
  cholesky_nugget: 1.0e-6
  pcg_max_iter: 500
  logdet_method: "cholmod"

# ----------------------------------------------------------------------------
# Spatial Domain
# ----------------------------------------------------------------------------
geometry:
  mode: "grid2d"
  nx: 40
  ny: 40
  h: 5.0  # Grid spacing in meters

# ----------------------------------------------------------------------------
# Prior Distribution (GMRF/SPDE) - âœ“ CV=30% (å·²éªŒè¯ä¼˜ç§€)
# ----------------------------------------------------------------------------
prior:
  # åŸºç¡€å‚æ•°
  nu: 1.0
  kappa: 0.10
  sigma2: 0.30
  alpha: 2
  beta: 1.0e-6
  mu_prior_mean: 2.2
  mu_prior_std: 0.3

  # éå¹³ç¨³å…ˆéªŒå‚æ•° - CV=30.11% (ä¼˜ç§€!)
  beta_base: 3.0        # éçƒ­ç‚¹åŒºåŸŸ nugget
  beta_hot: 1.0e-8      # çƒ­ç‚¹åŒºåŸŸ nugget

  # çƒ­ç‚¹åŒºåŸŸå®šä¹‰ (ç±³åæ ‡) - åŸŸ: 200m Ã— 200m
  hotspots:
    - center_m: [50, 50]
      radius_m: 45
    - center_m: [150, 50]
      radius_m: 45
    - center_m: [50, 150]
      radius_m: 45
    - center_m: [150, 150]
      radius_m: 45
    - center_m: [100, 100]
      radius_m: 50

# ----------------------------------------------------------------------------
# ğŸ”¥ Sensor Pool Configuration - OPTIMIZED FOR CONTRAST
# ----------------------------------------------------------------------------
sensors:
  # ğŸ”¥ ä¼˜åŒ–ï¼šå¢å¼º SNR-Cost å¯¹æ¯”åº¦ï¼Œæ‹‰å¼€ä¼ æ„Ÿå™¨å·®å¼‚
  types:
    # æä¾¿å®œä½†å™ªå£°æå¤§ï¼ˆæ™ºèƒ½æ‰‹æœº / ä¼—åŒ…æ•°æ®ï¼‰
    - name: "smartphone"
      noise_std: 1.0          # âœ… SNR â‰ˆ 2.2 (éå¸¸ä½)
      cost_gbp: 50            # âœ… æä½æˆæœ¬
      footprint: "point"

    # ä¸­ç­‰ç²¾åº¦+ä¸­ç­‰æˆæœ¬ï¼ˆåŸºç¡€ç‚¹ä¼ æ„Ÿå™¨ï¼‰
    - name: "basic_point"
      noise_std: 0.15         # âœ… SNR â‰ˆ 15
      cost_gbp: 150
      footprint: "point"

    # æé«˜ç²¾åº¦+æé«˜æˆæœ¬ï¼ˆæ¿€å…‰è½®å»“ä»ªï¼‰
    - name: "laser_profiler"
      noise_std: 0.05         # âœ… SNR â‰ˆ 44 (æé«˜)
      cost_gbp: 800           # âœ… æé«˜æˆæœ¬
      footprint: "point"

    # å¤§è¶³è¿¹+ä¸­é«˜å™ªå£°ï¼ˆèˆªç©ºæ‘„å½±æµ‹é‡ï¼‰
    - name: "photogrammetry"
      noise_std: 0.25         # âœ… SNR â‰ˆ 9
      cost_gbp: 400
      footprint: "avg5x5"     # âœ… 25 ä¸ªç‚¹çš„å¹³å‡

    # æå¤§è¶³è¿¹+é«˜å™ªå£°ï¼ˆè½¦è½½ç§»åŠ¨å¹³å‡ï¼‰
    - name: "vehicle_avg"
      noise_std: 0.35         # âœ… SNR â‰ˆ 6
      cost_gbp: 100
      footprint: "avg5x5"

  pool_strategy: "grid_subsample"
  pool_fraction: 0.3

  # ğŸ”¥ ä¼˜åŒ–ï¼šå¢åŠ æç«¯ç±»å‹ï¼ˆæä¾¿å®œ/æè´µï¼‰çš„æ¯”ä¾‹
  type_mix: [0.15, 0.35, 0.15, 0.20, 0.15]
  # è¯´æ˜ï¼š
  #   15% smartphoneï¼ˆæä¾¿å®œæå™ªï¼‰
  #   35% basic_pointï¼ˆä¸»åŠ›ï¼‰
  #   15% laser_profilerï¼ˆæè´µæå‡†ï¼‰
  #   20% photogrammetryï¼ˆå¤§è¶³è¿¹ï¼‰
  #   15% vehicle_avgï¼ˆå¤§è¶³è¿¹+é«˜å™ªï¼‰

# ----------------------------------------------------------------------------
# Decision Model (Economics) - âœ“ å·²ä¼˜åŒ– FN:FP = 15:1
# ----------------------------------------------------------------------------
decision:
  tau_iri: 2.2              # é˜ˆå€¼ä½äº 51.5th ç™¾åˆ†ä½ âœ“

  # Loss matrix (in GBP)
  L_TP_gbp: 5000            # True Positive: æ­£ç¡®ç»´æŠ¤
  L_FP_gbp: 10000           # False Positive: è¿‡åº¦ç»´æŠ¤
  L_FN_gbp: 150000          # False Negative: æ¼æ£€ä¸¥é‡è·¯æ®µ âœ“
  L_TN_gbp: 0               # True Negative: æ­£ç¡®è·³è¿‡

  # æˆæœ¬æ¯”ä¾‹: FN:FP = 15:1, FN:TP = 30:1 âœ“

# ----------------------------------------------------------------------------
# Sensor Selection Methods
# ----------------------------------------------------------------------------
selection:
  methods:
    - greedy_mi
    - greedy_aopt
    - greedy_evi
    - maxmin
    - uniform
    - random

  # é¢„ç®—ç‚¹åˆ†å¸ƒ
  budgets: [3, 5, 8, 10, 15, 20, 25, 30, 40, 50]

  # Method-specific configurations
  greedy_mi:
    batch_size: 1
    adaptive_pruning: true
    prune_threshold: 0.1
    max_candidates: null
    early_stop_ratio: null

  greedy_aopt:
    n_probes: 32            # âœ… ä» 16 å¢åŠ åˆ° 32ï¼ˆæ›´ç¨³å®šï¼‰
    use_cost: true

  # ğŸ”¥ EVI Configuration - EXPERT OPTIMIZED
  greedy_evi:
    n_y_samples: 8          # âœ… ä» 0 æ”¹ä¸º 8ï¼ˆå¯ç”¨ MC æ ¡å‡†ï¼‰
    use_cost: true

    # MI é¢„ç­›é€‰ - ğŸ”¥ å…³é”®ä¼˜åŒ–
    mi_prescreen: true
    keep_fraction: 0.6      # âœ… ä» 0.25 æ”¾å®½åˆ° 0.6

    # è¿è¡Œç­–ç•¥
    must_budgets: [5, 10, 20, 30]
    every_n_folds: 1        # æ¯ fold éƒ½è¿è¡Œ
    budgets_subset: []
    max_folds: null

  maxmin:
    use_cost: true

# ----------------------------------------------------------------------------
# Expected Value of Information (EVI) Computation
# ----------------------------------------------------------------------------
evi:
  compute_for: ["greedy_mi", "greedy_aopt", "greedy_evi"]
  method: "monte_carlo"
  monte_carlo_samples: 20

  unscented_alpha: 1.0
  unscented_beta: 2.0
  unscented_kappa: 0.0

# ----------------------------------------------------------------------------
# Cross-Validation
# ----------------------------------------------------------------------------
cv:
  scheme: "spatial_block"
  k_folds: 3
  buffer_width_multiplier: 1.5
  block_strategy: "kmeans"
  ensure_connected: true
  morans_permutations: 999

# ----------------------------------------------------------------------------
# Uncertainty Quantification
# ----------------------------------------------------------------------------
uq:
  bootstrap_method: "spatial_block"
  bootstrap_samples: 1000
  confidence_level: 0.95
  coverage_percentile: 90
  compute_crps: true

# ----------------------------------------------------------------------------
# Diagnostics
# ----------------------------------------------------------------------------
diagnostics:
  morans_i:
    compute: true
    permutations: 999
    alpha: 0.05

  calibration:
    pit_histogram: true
    coverage_curves: true
    reliability_diagram: true

# ----------------------------------------------------------------------------
# Visualization
# ----------------------------------------------------------------------------
plots:
  save_formats: [png, pdf]
  dpi: 300
  style: "seaborn-v0_8-paper"

  budget_curves:
    metrics: ["rmse", "expected_loss_gbp", "coverage_90"]
    show_confidence: true
    confidence_level: 0.95

  performance_profile:
    tau_values: [1.0, 1.05, 1.1, 1.2, 1.5, 2.0, 3.0]
    use_budget_fold_instances: true

  critical_difference:
    alpha: 0.05
    test: "nemenyi"

  expert_plots:
    enable_all: true        # âœ… å¯ç”¨æ‰€æœ‰ä¸“å®¶å›¾

    marginal_efficiency:
      enable: true
      normalize_by_cost: true

    type_composition:
      enable: true
      show_cost_breakdown: true

    mi_voi_correlation:
      enable: true
      methods: ["greedy_mi", "greedy_evi"]

    calibration_plots:
      enable: true

    spatial_diagnostics:
      enable: true
      show_morans_i: true

    ablation_study:
      enable: false

    sensor_placement_map:
      enable: true
      budgets_to_show: [5, 10, 20, 30, 50]

# ----------------------------------------------------------------------------
# Acceptance Criteria
# ----------------------------------------------------------------------------
acceptance:
  m1_grid_size: 100
  m1_budgets: [5, 10, 20]
  m1_check_monotonic: true
  m1_check_diminishing: true

  m2_min_improvement_vs_random: 0.15
  m2_confidence_level: 0.95

  m3_small_instance_n: 25
  m3_small_instance_k: 5
  m3_max_suboptimality: 0.10

  m4_morans_alpha: 0.05
  m4_coverage_tolerance: 0.10
  m4_msse_tolerance: 0.25