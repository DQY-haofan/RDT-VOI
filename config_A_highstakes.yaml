# ============================================================================
# RDT-VoI Configuration - SCENARIO A: HIGH-STAKES
# åœºæ™¯ Aï¼šé«˜é£é™©/è¿‘é˜ˆå€¼å†³ç­– - å‡¸æ˜¾ EVI ä¼˜åŠ¿
#
# æ ¸å¿ƒç‰¹å¾ï¼š
#   - é«˜ DDI (0.20-0.35): å¤§é‡åƒå…ƒå¤„äºå†³ç­–ä¸´ç•ŒåŒº
#   - å¼ºä¸å¯¹ç§°ä»£ä»· (FN:FP = 25:1): æ¼æ£€ä»£ä»·è¿œé«˜äºè¯¯æŠ¥
#   - ç¨€ç–å€™é€‰æ±  (20%): é€‰ç‚¹éš¾åº¦å¤§
#   - è¡ŒåŠ¨å—é™ (K_action=10): ç»´æŠ¤é¢„ç®—ç´§å¼ 
#
# é¢„æœŸç»“æœï¼šEVI åœ¨æœŸæœ›æŸå¤±ã€ROIã€Top-K å‘½ä¸­ç‡ä¸Šæ˜¾è‘—é¢†å…ˆ MI
# ============================================================================

experiment:
  name: "rdt_voi_A_highstakes"
  seed: 42
  output_dir: "results/A_highstakes"

# ----------------------------------------------------------------------------
# Numerical Settings
# ----------------------------------------------------------------------------
numerics:
  linear_solver_tol: 1.0e-8
  cholesky_nugget: 1.0e-6
  pcg_max_iter: 500
  logdet_method: "cholmod"

# ----------------------------------------------------------------------------
# Spatial Domain (20x20 ç½‘æ ¼ï¼Œæ€» 400 åƒå…ƒ)
# ----------------------------------------------------------------------------
geometry:
  mode: "grid2d"
  nx: 20
  ny: 20
  h: 5.0

# ----------------------------------------------------------------------------
# Prior Distribution (GMRF/SPDE) - ä¿æŒé«˜æ–¹å·®çƒ­ç‚¹
# ----------------------------------------------------------------------------
prior:
  nu: 1.0
  kappa: 0.10
  sigma2: 0.30
  alpha: 2
  beta: 1.0e-6
  mu_prior_mean: 2.2
  mu_prior_std: 0.3

  beta_base: 5.0
  beta_hot: 1.0e-4

  hotspots:
    - center_m: [25, 75]
      radius_m: 20
    - center_m: [75, 25]
      radius_m: 25
    - center_m: [50, 50]
      radius_m: 15

# ----------------------------------------------------------------------------
# Sensor Pool Configuration - ğŸ”¥ ç¨€ç–æ± ï¼ˆ20%ï¼‰
# ----------------------------------------------------------------------------
sensors:
  types:
    - name: smartphone
      noise_std: 0.50
      cost_gbp: 30
      footprint: point

    - name: "basic_point"
      noise_std: 0.15
      cost_gbp: 150
      footprint: "point"

    - name: "laser_profiler"
      noise_std: 0.05
      cost_gbp: 800
      footprint: "point"

    - name: photogrammetry
      noise_std: 0.25
      cost_gbp: 100
      footprint: avg3x3

    - name: "vehicle_avg"
      noise_std: 0.35
      cost_gbp: 100
      footprint: "avg5x5"

    - name: inertial_profiler
      noise_std: 0.15
      cost_gbp: 300
      footprint: avg3x3

  pool_strategy: "grid_subsample"
  pool_fraction: 0.20  # ğŸ”¥ ç¨€ç–æ± ï¼šä»… 80 ä¸ªå€™é€‰ä½ç½®ï¼ˆ400Ã—0.2ï¼‰
  type_mix: [0.15, 0.20, 0.10, 0.20, 0.15, 0.20]

  use_heterogeneous: true
  cost_zones:
    - center_m: [100, 100]
      radius_m: 50
      cost_multiplier: 1.5
      noise_multiplier: 0.8
      allowed_types: ['inertial_profiler', 'photogrammetry']

# ----------------------------------------------------------------------------
# Decision Model - ğŸ”¥ é«˜é£é™©å‚æ•°
# ----------------------------------------------------------------------------
decision:
  tau_iri: null
  tau_quantile: 0.85  # ğŸ”¥ é«˜åˆ†ä½é˜ˆå€¼ï¼Œæå‡ DDI ä½†é¿å… 100%

  # ğŸ”¥ å¼ºä¸å¯¹ç§°ä»£ä»·æ¯” (25:1)
  L_FP_gbp: 5000.0      # è¯¯æŠ¥ï¼šæµªè´¹ç»´æŠ¤èµ„æº
  L_FN_gbp: 125000.0    # ğŸ”¥ æ¼æ£€ï¼šè·¯æ®µå¤±ä¿®å¯¼è‡´äº‹æ•…/è¯‰è®¼
  L_TP_gbp: 800.0       # æ­£ç¡®ç»´æŠ¤çš„æˆæœ¬
  L_TN_gbp: 0.0

  target_ddi: 0.25      # ğŸ¯ ç›®æ ‡ DDI: 25%ï¼ˆé…åˆé€ç‚¹ Ïƒ è®¡ç®—ï¼‰
  K_action: 10          # ğŸ”¥ è¡ŒåŠ¨å—é™ï¼šæœ€å¤šç»´æŠ¤ 10 ä¸ªä½ç½®

# ----------------------------------------------------------------------------
# Sensor Selection Methods - ğŸ”¥ å‰æ®µé¢„ç®—å¯†é›†
# ----------------------------------------------------------------------------
selection:
  methods:
    - greedy_evi
    - greedy_mi
    - greedy_aopt
    - maxmin
    - uniform
    - random

  budget_type: "count"
  budgets: [3, 5, 10, 15, 20]  # ğŸ”¥ å‰æ®µå¯†é›†ï¼Œå·®è·æ›´æ˜æ˜¾

  greedy_mi:
    batch_size: 1
    adaptive_pruning: true
    prune_threshold: 0.10
    use_cost: true

  greedy_aopt:
    n_probes: 32
    use_cost: true

  greedy_evi:
    n_y_samples: 0        # ğŸ”¥ è§£ææ³•ï¼ˆæ›´å¿«ï¼‰
    use_cost: true
    mi_prescreen: true
    keep_fraction: 0.50   # ğŸ”¥ é¢„ç­› 50%ï¼Œå¹³è¡¡ç²¾åº¦ä¸é€Ÿåº¦

  maxmin:
    use_cost: true

# ----------------------------------------------------------------------------
# Expected Value of Information - ğŸ”¥ è¶³å¤Ÿæ ·æœ¬ç¡®ä¿ç¨³å®š
# ----------------------------------------------------------------------------
evi:
  compute_for: ["greedy_mi", "greedy_aopt", "greedy_evi"]
  method: "monte_carlo"
  monte_carlo_samples: 32  # ğŸ”¥ 32 æ ·æœ¬ï¼šå¤Ÿç¨³åˆä¸è¿‡æ…¢

# ----------------------------------------------------------------------------
# Cross-Validation
# ----------------------------------------------------------------------------
cv:
  scheme: "spatial_block"
  k_folds: 3
  buffer_width_multiplier: 1.5
  block_strategy: "kmeans"
  ensure_connected: true
  morans_permutations: 999

# ----------------------------------------------------------------------------
# Uncertainty Quantification
# ----------------------------------------------------------------------------
uq:
  bootstrap_method: "spatial_block"
  bootstrap_samples: 1000
  confidence_level: 0.95
  coverage_percentile: 90
  compute_crps: true

# ----------------------------------------------------------------------------
# Diagnostics
# ----------------------------------------------------------------------------
diagnostics:
  morans_i:
    compute: true
    permutations: 999
    alpha: 0.05

  calibration:
    pit_histogram: true
    coverage_curves: true
    reliability_diagram: true

# ----------------------------------------------------------------------------
# ğŸ”¥ Visualization - çªå‡º EVI çš„ä¸šåŠ¡ä»·å€¼ä¼˜åŠ¿
# ----------------------------------------------------------------------------
plots:
  save_formats: [png, pdf]
  dpi: 300
  style: "seaborn-v0_8-paper"

  budget_curves:
    metrics: ["rmse", "expected_loss_gbp", "coverage_90"]
    show_confidence: true
    confidence_level: 0.95

  performance_profile:
    tau_values: [1.0, 1.05, 1.1, 1.2, 1.5, 2.0, 3.0]
    use_budget_fold_instances: true

  critical_difference:
    alpha: 0.05
    test: "nemenyi"

  business_metrics:
    enable: true
    baseline_method: "uniform"
    show_savings: true      # ğŸ”¥ æ˜¾ç¤º EVI ç›¸å¯¹ MI çš„çœé’±å¹…åº¦
    show_roi: true          # ğŸ”¥ æ˜¾ç¤ºæŠ•èµ„å›æŠ¥ç‡
    show_cost_efficiency: true

  effect_size:
    enable: true
    plot_heatmaps: true
    plot_pairwise_table: true
    top_k_comparisons: 20

  critical_region:
    enable: true
    epsilon: 0.2
    plot_heatmap: true

  expert_plots:
    enable_all: true

    marginal_efficiency:
      enable: true
      normalize_by_cost: true
      unit: "gbp_per_test_point"

    type_composition:
      enable: true
      show_cost_breakdown: true

    mi_voi_correlation:
      enable: true
      methods: ["greedy_mi", "greedy_evi"]

    calibration_plots:
      enable: true

    spatial_diagnostics:
      enable: true
      show_morans_i: true

    sensor_placement_map:
      enable: true
      budgets_to_show: [5, 10, 15, 20]

    roi_curves:
      enable: true  # ğŸ”¥ ROI æ›²çº¿ï¼šEVI åº”æ›´é™¡å³­

    robustness_heatmap:
      enable: false  # åœºæ™¯ A ä¸å¼ºè°ƒé²æ£’æ€§

    ddi_overlay:
      enable: true  # ğŸ”¥ å åŠ  EVI vs MI çš„é€‰ç‚¹åˆ†å¸ƒ

# ----------------------------------------------------------------------------
# Acceptance Criteria
# ----------------------------------------------------------------------------
acceptance:
  m1_grid_size: 100
  m1_budgets: [5, 10, 20]
  m1_check_monotonic: true
  m1_check_diminishing: true

  m2_min_improvement_vs_random: 0.15
  m2_confidence_level: 0.95

  m3_small_instance_n: 25
  m3_small_instance_k: 5
  m3_max_suboptimality: 0.10

  m4_morans_alpha: 0.05
  m4_coverage_tolerance: 0.10
  m4_msse_tolerance: 0.25

# ============================================================================
# åœºæ™¯ A é¢„æœŸç»“æœ
# ============================================================================
# 1. EVI æœŸæœ›æŸå¤±æ¯” MI ä½ 8-15%ï¼ˆåœ¨ n=5-15 æ®µï¼‰
# 2. EVI çš„ ROI æ›²çº¿æ›´é™¡å³­ï¼ˆå•ä½ä¼ æ„Ÿå™¨æˆæœ¬çš„æŸå¤±é™ä½æ›´å¤§ï¼‰
# 3. Top-K=10 å‘½ä¸­ç‡ï¼šEVI åœ¨çœŸæ­£é«˜é£é™©åŒºåŸŸçš„è¦†ç›–ç‡æ›´é«˜
# 4. DDI çƒ­å›¾æ˜¾ç¤ºï¼šEVI é€‰ç‚¹æ›´é›†ä¸­åœ¨ Ï„Â±0.2 çš„ä¸´ç•ŒåŒº
# 5. Critical Difference å›¾ï¼šEVI ä¸ MI è¾¾åˆ°ç»Ÿè®¡æ˜¾è‘—æ€§ï¼ˆp<0.05ï¼‰
# ============================================================================